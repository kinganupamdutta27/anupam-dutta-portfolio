{% extends "accounts/base_dashboard.html" %}

{% block title %}Edit Job - {{ job.title }}{% endblock %}

{% block dashboard_content %}
<div class="dashboard-header">
    <div>
        <h1>Edit Job Post</h1>
        <p class="text-muted">Update your job posting</p>
    </div>
</div>

<div class="form-card">
    {% if form.non_field_errors %}
        <div class="alert alert-error">
            {% for error in form.non_field_errors %}
                {{ error }}
            {% endfor %}
        </div>
    {% endif %}

    <form method="post" enctype="multipart/form-data" novalidate>
        {% csrf_token %}
        
        <h3 style="font-size: 1.1rem; margin-bottom: 1.5rem; padding-bottom: 0.75rem; border-bottom: 1px solid var(--border-color);">
            <i class="fas fa-building" style="margin-right: 0.5rem; color: var(--primary);"></i> Company Information
        </h3>

        <div class="form-row">
            <div class="form-group">
                <label for="company_name" class="form-label">Company Name *</label>
                <input type="text" id="company_name" name="company_name" 
                       class="form-control {% if form.company_name.errors %}error{% endif %}"
                       value="{{ form.company_name.value|default:'' }}" required>
                {% if form.company_name.errors %}
                    <span class="form-error">{{ form.company_name.errors.0 }}</span>
                {% endif %}
            </div>
            <div class="form-group">
                <label for="company_website" class="form-label">Company Website</label>
                <input type="url" id="company_website" name="company_website" 
                       class="form-control"
                       value="{{ form.company_website.value|default:'' }}">
            </div>
        </div>

        <div class="form-group">
            <label for="company_logo" class="form-label">Company Logo</label>
            {% if job.company_logo %}
                <div style="margin-bottom: 0.75rem;">
                    <img src="{{ job.company_logo.url }}" alt="Logo" 
                         style="width: 60px; height: 60px; border-radius: 8px; object-fit: contain; background: rgba(255,255,255,0.05);">
                </div>
            {% endif %}
            <input type="file" id="company_logo" name="company_logo" 
                   class="form-control" accept="image/*">
        </div>

        <h3 style="font-size: 1.1rem; margin: 2rem 0 1.5rem; padding-bottom: 0.75rem; border-bottom: 1px solid var(--border-color);">
            <i class="fas fa-briefcase" style="margin-right: 0.5rem; color: var(--primary);"></i> Job Details
        </h3>

        <div class="form-group">
            <label for="title" class="form-label">Job Title *</label>
            <input type="text" id="title" name="title" 
                   class="form-control {% if form.title.errors %}error{% endif %}"
                   value="{{ form.title.value|default:'' }}" required>
            {% if form.title.errors %}
                <span class="form-error">{{ form.title.errors.0 }}</span>
            {% endif %}
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="job_type" class="form-label">Job Type *</label>
                <select id="job_type" name="job_type" class="form-control">
                    {% for value, label in form.fields.job_type.choices %}
                        <option value="{{ value }}" {% if form.job_type.value == value %}selected{% endif %}>{{ label }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label for="experience_level" class="form-label">Experience Level *</label>
                <select id="experience_level" name="experience_level" class="form-control">
                    {% for value, label in form.fields.experience_level.choices %}
                        <option value="{{ value }}" {% if form.experience_level.value == value %}selected{% endif %}>{{ label }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="location" class="form-label">Location *</label>
                <input type="text" id="location" name="location" 
                       class="form-control {% if form.location.errors %}error{% endif %}"
                       value="{{ form.location.value|default:'' }}" required>
                {% if form.location.errors %}
                    <span class="form-error">{{ form.location.errors.0 }}</span>
                {% endif %}
            </div>
            <div class="form-group" style="display: flex; align-items: center; padding-top: 1.5rem;">
                <div class="form-check">
                    <input type="checkbox" id="is_remote" name="is_remote" 
                           class="form-check-input" {% if form.is_remote.value %}checked{% endif %}>
                    <label for="is_remote" class="form-check-label">This is a remote position</label>
                </div>
            </div>
        </div>

        <div class="form-group">
            <label for="description" class="form-label">Job Description *</label>
            <textarea id="description" name="description" 
                      class="form-control {% if form.description.errors %}error{% endif %}"
                      rows="6" required>{{ form.description.value|default:'' }}</textarea>
            {% if form.description.errors %}
                <span class="form-error">{{ form.description.errors.0 }}</span>
            {% endif %}
        </div>

        <div class="form-group">
            <label for="requirements" class="form-label">Requirements *</label>
            <textarea id="requirements" name="requirements" 
                      class="form-control {% if form.requirements.errors %}error{% endif %}"
                      rows="4" required>{{ form.requirements.value|default:'' }}</textarea>
            {% if form.requirements.errors %}
                <span class="form-error">{{ form.requirements.errors.0 }}</span>
            {% endif %}
        </div>

        <div class="form-group">
            <label for="responsibilities" class="form-label">Key Responsibilities</label>
            <textarea id="responsibilities" name="responsibilities" 
                      class="form-control" rows="4">{{ form.responsibilities.value|default:'' }}</textarea>
        </div>

        <div class="form-group">
            <label for="benefits" class="form-label">Benefits & Perks</label>
            <textarea id="benefits" name="benefits" 
                      class="form-control" rows="3">{{ form.benefits.value|default:'' }}</textarea>
        </div>

        <div class="form-group">
            <label for="skills_required" class="form-label">Required Skills</label>
            <input type="text" id="skills_required" name="skills_required" 
                   class="form-control"
                   value="{{ form.skills_required.value|default:'' }}">
        </div>

        <h3 style="font-size: 1.1rem; margin: 2rem 0 1.5rem; padding-bottom: 0.75rem; border-bottom: 1px solid var(--border-color);">
            <i class="fas fa-dollar-sign" style="margin-right: 0.5rem; color: var(--primary);"></i> Compensation
        </h3>

        <div class="form-row">
            <div class="form-group">
                <label for="salary_min" class="form-label">Minimum Salary</label>
                <input type="number" id="salary_min" name="salary_min" 
                       class="form-control"
                       value="{{ form.salary_min.value|default:'' }}"
                       min="0" step="1000">
            </div>
            <div class="form-group">
                <label for="salary_max" class="form-label">Maximum Salary</label>
                <input type="number" id="salary_max" name="salary_max" 
                       class="form-control"
                       value="{{ form.salary_max.value|default:'' }}"
                       min="0" step="1000">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="salary_currency" class="form-label">Currency</label>
                <input type="text" id="salary_currency" name="salary_currency" 
                       class="form-control"
                       value="{{ form.salary_currency.value|default:'INR' }}">
            </div>
            <div class="form-group" style="display: flex; align-items: center; padding-top: 1.5rem;">
                <div class="form-check">
                    <input type="checkbox" id="show_salary" name="show_salary" 
                           class="form-check-input" {% if form.show_salary.value %}checked{% endif %}>
                    <label for="show_salary" class="form-check-label">Display salary publicly</label>
                </div>
            </div>
        </div>

        <h3 style="font-size: 1.1rem; margin: 2rem 0 1.5rem; padding-bottom: 0.75rem; border-bottom: 1px solid var(--border-color);">
            <i class="fas fa-envelope" style="margin-right: 0.5rem; color: var(--primary);"></i> Contact Information
        </h3>

        <div class="form-row">
            <div class="form-group">
                <label for="contact_email" class="form-label">Contact Email *</label>
                <input type="email" id="contact_email" name="contact_email" 
                       class="form-control {% if form.contact_email.errors %}error{% endif %}"
                       value="{{ form.contact_email.value|default:'' }}" required>
                {% if form.contact_email.errors %}
                    <span class="form-error">{{ form.contact_email.errors.0 }}</span>
                {% endif %}
            </div>
            <div class="form-group">
                <label for="contact_phone" class="form-label">Contact Phone</label>
                <input type="tel" id="contact_phone" name="contact_phone" 
                       class="form-control"
                       value="{{ form.contact_phone.value|default:'' }}">
            </div>
        </div>

        <div class="form-group">
            <label for="application_url" class="form-label">Application URL</label>
            <input type="url" id="application_url" name="application_url" 
                   class="form-control"
                   value="{{ form.application_url.value|default:'' }}">
        </div>

        <div style="display: flex; gap: 1rem; margin-top: 2rem;">
            <button type="submit" class="btn btn-primary">
                <i class="fas fa-save"></i> Save Changes
            </button>
            <a href="{% url 'jobs:my_jobs' %}" class="btn btn-outline">Cancel</a>
        </div>
    </form>
</div>
{% endblock %}
